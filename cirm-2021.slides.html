<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Peter Ralph   University of Oregon   Institute of Ecology and Evolution">
  <title>What’s the effect of dispersal?  How gene flow depends on ecology.</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js@^4//dist/reset.css">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js@^4//dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="https://unpkg.com/reveal.js@^4//dist/theme/simple.css" id="theme">
  <style type="text/css">

  .reveal { font-size: 30px; }

  .reveal h1 { font-size: 1.5em; } 

  .reveal h2 { font-size: 1.2em; } 

  .reveal .slides { text-align: left; }

  .reveal .slides figure { text-align: center; }

  .centered p { text-align: center; }

  /* apply this to the columns div */
  div.vcentered { display: flex; align-items: center; }

  .caption p { font-size: 75%; }

  .greyed { color: #4444; }

  div.floatright { float: right; text-align: right; }

  .reveal figcaption { display: none; }

  .reveal img { border: none; }

  .reveal section img { border: none; }

  .MathJax_Display { margin: 0; }

  img.finger { vertical-align: text-top; }

  .smaller { font-size: 50%; }
  .smallish { font-size: 80%; }

  .hide { opacity: 0; }

  </style>

  <div style="display: none">
  \[
  \usepackage{amsmath}
  \usepackage{amssymb}
  \usepackage{xcolor}

  \newcommand{\R}{\mathbb{R}}
  \newcommand{\Q}{\mathbb{Q}}
  \newcommand{\Z}{\mathbb{Z}}
  \newcommand{\N}{\mathbb{N}}
  \newcommand{\C}{\mathbb{C}}

  \renewcommand{\P}{\mathbb{P}}
  \newcommand{\E}{\mathbb{E}}

  \newcommand{\var}{\mathop{\mbox{Var}}}
  \newcommand{\cov}{\mathop{\mbox{cov}}}
  \newcommand{\median}{\mathop{\mbox{median}}}
  %\newcommand{\det}{\mathop{\mbox{det}}}
  \newcommand{\supp}{\mathop{\mbox{supp}}}
  \newcommand{\sgn}{\mathop{\mbox{sgn}}}

  \newcommand{\conv}{\mathop{\mbox{conv}}}
  \newcommand{\deq}{\stackrel{\scriptscriptstyle{d}}{=}}
  \newcommand{\dcv}{\stackrel{\scriptscriptstyle{d}}{\longrightarrow}}

  \]
  </div>
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">What’s the effect of dispersal?<br/> How gene flow depends on ecology.</h1>
  <p class="author">Peter Ralph <br/> University of Oregon <br/> Institute of Ecology and Evolution</p>
  <p class="date">5th Workshop Probability and Evolution<br/><em>slides:</em> <a href="https://github.com/petrelharp/cirm_2021_talk">github:petrelharp/cirm_2021_talk</a></p>
</section>

<section>
<section id="the-problem-of-geography" class="title-slide slide level1">
<h1>The “problem” of geography</h1>
<figure>
<img data-src="figs/france-geology.png" alt="geological map of france" /><figcaption aria-hidden="true">geological map of france</figcaption>
</figure>
</section>
<section id="waldo-toblers-first-law" class="slide level2">
<h2>Waldo Tobler’s First Law</h2>
<blockquote>
<p>Everything is related to everything else, but near things are more related than distant things.</p>
</blockquote>
<div class="fragment">
<figure>
<img data-src="figs/spatial_pedigree.png" alt="spatial pedigree" /><figcaption aria-hidden="true">spatial pedigree</figcaption>
</figure>
</div>
</section>
<section id="isolation-by-distance" class="slide level2">
<h2>“Isolation by distance”</h2>
<p>… means that genetic distance increases with geographic (straight-line) distance, where <span class="math display">\[\begin{aligned}
    d(i,j)
    &amp;= \text{(genetic distance between individuals $i$ and $j$)} \\
    &amp;= \frac{\text{number of nucleotide differences}}{\text{length of the genome}} .
\end{aligned}\]</span></p>
<div class="fragment">
<p>The <em>Wright-Malecót formula</em> says that in 2D: <span class="math display">\[\begin{aligned}
   \mathbb{E}[d(i, j)]
   &amp;=
   \frac{1}{\mathcal{N} + \log(\sigma_e / (\kappa \sqrt{2\mu}))}
    K_0\left( \frac{\sqrt{2\mu}|x_i-x_j|}{\sigma_e} \right) .
\end{aligned}\]</span> (see e.g., Barton, Depaulis &amp; Etheridge (2002); Smith &amp; Weissman 2020)</p>
</div>
<div class="fragment">
<p><strong>But:</strong> what’s <span class="math inline">\(\sigma_e\)</span>?</p>
</div>
</section>
<section id="tracing-back-lineages" class="slide level2">
<h2>Tracing back lineages</h2>
<p>The <em>lineage</em> of a bit of genome at location <span class="math inline">\(x\)</span> today is <span class="math display">\[\begin{aligned}
   L_t = \text{(location of the genetic ancestor at time $t$ ago)},
\end{aligned}\]</span> with <span class="math inline">\(L_0 = x\)</span>.</p>
<div class="fragment">
<p>Properties:</p>
<ol type="1">
<li><p>stationary distribution is long-term fitness</p></li>
<li><p><span class="math inline">\(\sigma_e\)</span> is determined by <span class="math inline">\(L_t\)</span></p></li>
</ol>
</div>
</section>
<section id="questions" class="slide level2">
<h2>Questions:</h2>
<p>Let <span class="math inline">\(\sigma^2_e = \lim_{t \to \infty} \mathbb{E}[L_t^2]\)</span>.</p>
<div class="fragment">
<p>What determines the sign of <span class="math display">\[\sigma_e - \sigma ? \]</span></p>
</div>
<div class="fragment">
<p>How <em>does</em> <span class="math inline">\(L_t\)</span> move, anyhow?</p>
</div>
</section></section>
<section>
<section id="a-discrete-model" class="title-slide slide level1">
<h1>A discrete model</h1>
<div class="columns">
<div class="column">
<p>Discrete space and time, but varying population sizes.</p>
<p>Goal: understand sources of variation.</p>
<p>Movement only happens at <em>reproduction</em> (think about plants).</p>
</div><div class="column" style="width:50%;">
<figure>
<img data-src="figs/flower.png" alt="Drummond’s anemone" /><figcaption aria-hidden="true">Drummond’s anemone</figcaption>
</figure>
</div>
</div>
</section>
<section id="section" class="slide level2">
<h2></h2>
<p>Suppose: <span class="math display">\[\begin{aligned}
    N(x,t)
        &amp;= \text{(number of individuals $t$ generations ago at $x$)} \\
    m(x, y)
        &amp;= \text{(proportion of seeds from $x$ that go to $y$)}
\end{aligned}\]</span></p>
<p>… and surviving individuals are uniform choices out of available seeds.</p>
<div class="fragment">
<p>and so <span class="math display">\[\begin{aligned}
    \mathbb{P}\{ L_{t+1} = y \;|\; L_t = x \}
        &amp;= \frac{ N(y,t) m(y, x) } { \sum_z N(z,t) m(z, x) } .
\end{aligned}\]</span></p>
</div>
</section></section>
<section>
<section id="bigsmall-worlds" class="title-slide slide level1">
<h1>Big/small worlds</h1>

</section>
<section id="much-much-simpler" class="slide level2">
<h2>Much, much simpler:</h2>
<p>Assume that:</p>
<ol start="0" type="1">
<li><p>We’re in one dimension.</p></li>
<li><p><span class="math inline">\(L_t\)</span> is Markov given <span class="math inline">\(N\)</span> (generally requires <span class="math inline">\(N\)</span> to be large).</p></li>
<li><p><span class="math inline">\(N(x,t)\)</span> is reversible, Markov, and stationary.</p></li>
<li><p><span class="math inline">\(N(x,t) \in \{G, B\}\)</span>, with <span class="math inline">\(G \gg B\)</span>.</p></li>
<li><p><span class="math inline">\(m(x,y) = 1/3\)</span> if <span class="math inline">\(|x-y| \le 1\)</span>.</p></li>
</ol>
<div class="fragment">
<p><span class="math display">\[\begin{aligned}
    \text{Note: forwards dispersal has } \sigma^2 = \frac{2}{3} .
\end{aligned}\]</span></p>
</div>
<div class="fragment">
<p>Then <span class="math inline">\(L_{t+1} \; | L_t = x\)</span>:</p>
<ul>
<li>chooses a “good” patch uniformly from <span class="math inline">\(\{x-1, x, x+1\}\)</span>, if any;</li>
<li>if not, chooses a neighboring patch uniformly.</li>
</ul>
</div>
</section>
<section id="case-1-no-temporal-correlations" class="slide level2">
<h2>Case 1: no temporal correlations</h2>
<p>Suppose</p>
<ul>
<li><span class="math inline">\(N(t, \cdot)\)</span> is independent for each <span class="math inline">\(t\)</span>, and</li>
<li><span class="math inline">\(N(t, x)\)</span> is Markov in <span class="math inline">\(x\)</span> with states <span class="math inline">\(\{G, B\}\)</span> and transition matrix <span class="math display">\[\begin{aligned}
  P = \begin{bmatrix}
    1-p &amp; p \\
    q &amp; 1-q \\
   \end{bmatrix} .
\end{aligned}\]</span></li>
</ul>
</section>
<section class="slide level2">

<table>
<thead>
<tr class="header">
<th>habitat</th>
<th>probability</th>
<th><span class="math inline">\((\Delta L)^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GGG</td>
<td><span class="math inline">\(\frac{p}{p+q} (1-q)^2\)</span></td>
<td>2/3</td>
</tr>
<tr class="even">
<td>GGB/BGG</td>
<td><span class="math inline">\(\frac{p}{p+q} (1-q)q\)</span></td>
<td>1/2</td>
</tr>
<tr class="odd">
<td>GBB/BBG</td>
<td><span class="math inline">\(\frac{p}{p+q} q(1-p)\)</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>GBG</td>
<td><span class="math inline">\(\frac{p}{p+q} qp\)</span></td>
<td>1</td>
</tr>
<tr class="odd">
<td>BGB</td>
<td><span class="math inline">\(\frac{q}{p+q} pq\)</span></td>
<td>0</td>
</tr>
<tr class="even">
<td>BBB</td>
<td><span class="math inline">\(\frac{q}{p+q} (1-p)^2\)</span></td>
<td>2/3</td>
</tr>
</tbody>
</table>
<div class="fragment">
<p><span class="math display">\[\begin{aligned}
    \mathbb{E}[(L_1 - L_0)^2]
    =
    \frac{2}{3} + \frac{ pq } {3 (p + q) } \left(1 - (p + q)\right) .
\end{aligned}\]</span></p>
</div>
</section>
<section class="slide level2">

<div class="columns">
<div class="column" style="width:60%;">
<p><span class="math display">\[\begin{aligned}
    &amp;\sigma^2_e  - \frac{2}{3}  \\
    &amp;\qquad {} = \frac{ pq } {3 (p + q) } \left(1 - (p + q)\right) .
\end{aligned}\]</span> and so <span class="math display">\[\begin{aligned}
    \sigma_e &gt; \sigma \qquad \text{iff} \quad p + q &lt; 1,
\end{aligned}\]</span></p>
<p>i.e., iff</p>
<ul>
<li><span class="math inline">\(P\)</span> has only positive eigenvalues.</li>
<li>the environment does not oscillate.</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="figs/bigsmall_dvar.png" /></p>
</div>
</div>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column">
<p><strong>So:</strong> the random environment can <em>either</em> slow down <em>or</em> speed up a lineage</p>
<p>… even with <em>no</em> temporal correlations!</p>
</div><div class="column" style="width:50%;">
<p><img data-src="figs/bigsmall_dvar.png" /></p>
</div>
</div>
</section>
<section id="what-about-temporal-correlations" class="slide level2">
<h2>What about temporal correlations?</h2>
<div class="columns">
<div class="column">
<p>With a reversible-in-time Markovian environment, at stationarity, with the <em>same</em> distribution in space,</p>
</div><div class="column" style="width:50%;">
<figure>
<img data-src="figs/run_BURNIN_1000_NUMGENS_15000_W_300_GAMMA_B_0.2_GAMMA_M_0.1_seed_1302.lineages.png" alt="a simulation" /><figcaption aria-hidden="true">a simulation</figcaption>
</figure>
</div>
</div>
</section>
<section id="what-about-temporal-correlations-1" class="slide level2">
<h2>What about temporal correlations?</h2>
<div class="columns">
<div class="column">
<p>With a reversible-in-time Markovian environment, at stationarity, with the <em>same</em> distribution in space,</p>
<p>changing temporal correlations can also increase <em>or</em> decrease speed.</p>
</div><div class="column" style="width:50%;">
<p><img data-src="figs/speeds_vs_gamma_m.png" /></p>
</div>
</div>
</section></section>
<section>
<section id="a-model-for-diffusion-limits" class="title-slide slide level1">
<h1>A model for diffusion limits</h1>
<p>Now let’s move to <em>continuous space</em>.</p>
</section>
<section id="the-model" class="slide level2">
<h2>The model:</h2>
<p>Birth, establishment, and establishment rates depend on local population densities (like Bolker-Pacala):</p>
<ul>
<li><span class="math inline">\(N\)</span>: scaling factor for density</li>
<li><span class="math inline">\(\eta_t\)</span>: point measure with <span class="math inline">\(1/N\)</span> for each individual</li>
<li><span class="math inline">\(\epsilon\)</span>: interaction distance</li>
<li><span class="math inline">\(\bar \eta_t = p_\epsilon * \eta_t / N\)</span>: rescaled, smoothed population density</li>
<li><span class="math inline">\(p_\epsilon\)</span>: the heat kernel</li>
<li><span class="math inline">\(\gamma(x, \bar \eta_t(x))\)</span>: per capita birth rate at <span class="math inline">\(x\)</span></li>
<li><span class="math inline">\(q(x, y)\)</span>: probability density a juvenile disperses to <span class="math inline">\(y\)</span></li>
<li><span class="math inline">\(r(y, \bar \eta_t(y))\)</span>: juvenile establishment probability at <span class="math inline">\(y\)</span></li>
<li><span class="math inline">\(\mu(x, \bar \eta_t(x))\)</span>: death rate at <span class="math inline">\(x\)</span></li>
</ul>
</section>
<section id="for-instance" class="slide level2">
<h2>For instance</h2>
<p><em>Mortality increases with crowding:</em> <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(r\)</span> are constant, while <span class="math display">\[\begin{aligned}
    \mu(x, u)
    &amp;= \mu_0 \left( 1 - \frac{1}{1 + \exp(u)} \right) .
\end{aligned}\]</span></p>
</section>
<section id="or-for-instance" class="slide level2">
<h2>Or, for instance</h2>
<p><em>Fecundity decreasing with crowding:</em> <span class="math inline">\(\mu\)</span> and <span class="math inline">\(r\)</span> are constant, while <span class="math display">\[\begin{aligned}
    \gamma(x, u)
    &amp;= \gamma_0 \left( \frac{1}{1 + \exp(u)} \right) .
\end{aligned}\]</span></p>
</section>
<section id="hows-the-density-change" class="slide level2">
<h2>How’s the density change?</h2>
<p><span class="math display">\[\begin{aligned}
    &amp; \hphantom{\int} \; N \bar \eta(y) \gamma(y, \bar \eta) \; \hphantom{q(y, dx)} &amp;\qquad &amp;\text{(birth at $y$)} \\
    &amp; \int \; \hphantom{N \bar \eta(y) \gamma(y, \bar \eta)} \; q(y, dx) r(x, \bar \eta) &amp;\qquad &amp;\text{(dispersal to $x$)}
\end{aligned}\]</span></p>
<p><strong>and</strong></p>
<p><span class="math display">\[\begin{aligned}
    &amp; {} - N \bar \eta (x) \mu(x, \bar \eta)  &amp; \qquad &amp;\text{(death)}
\end{aligned}\]</span></p>
</section>
<section id="the-mean-measure" class="slide level2">
<h2>The mean measure</h2>
<p>So: for a test function <span class="math inline">\(f\)</span>, <span class="math display">\[\begin{aligned}
    &amp;
    \lim_{dt \searrow 0} \frac{1}{dt}
        \left. \mathbb{E} \left[
            \int f(x) \bar \eta_{dt}(dx) - \int f(x) \bar \eta_0(dx)
        \;|\; \bar \eta_0 = \bar \eta \right] \right\vert_{t=0} \\
    &amp;\qquad
    = \int \int f(z) r(z, \bar \eta) q(x, dz) \gamma(x, \bar \eta) \bar \eta(dx) \\
    &amp;\qquad \qquad {}
    - \int f(x) \mu(x, \bar \eta) \bar \eta(dx) .
\end{aligned}\]</span></p>
<div class="fragment">
<p><span class="math display">\[\begin{aligned}
    &amp;{}
    = \int \left\{ \int \left( f(z) r(z, \bar \eta) 
                              - f(x) r(x, \bar \eta) \right) 
                         q(x, dz) \right\}
             \gamma(x, \bar \eta) \bar \eta(dx) \\
    &amp;\qquad \qquad {}
    + \int f(x)
        \left\{
            r(x, \bar \eta) \gamma(x, \bar \eta)
            - \mu(x, \bar \eta)
        \right\}
      \bar \eta(dx) .
\end{aligned}\]</span></p>
</div>
</section></section>
<section>
<section id="limits" class="title-slide slide level1">
<h1>Limits</h1>

</section>
<section class="slide level2">

<p>Rescale <em>time</em> by <span class="math inline">\(\theta\)</span>. As <span class="math inline">\(\theta \to \infty\)</span>:</p>
<div class="fragment">
<p>to see <em>lineages</em> moving, we need variance of dispersal distance of <span class="math inline">\(1/\theta\)</span>, and <span class="math display">\[
    \theta \int g(y) q_\theta(x, dy) \to \Delta g(x)
\]</span></p>
</div>
<div class="fragment">
<p>Suppose the <em>density measure</em> converges: <span class="math display">\[
    \bar \eta_\theta \to \Xi
\]</span></p>
</div>
<div class="fragment">
<p>Long-term behavior is “near equilibrium”: <span class="math display">\[
    \theta\left(
        r(x, \bar \eta) \gamma(x, \bar \eta)
        - \mu(x, \bar \eta)
    \right)
        \to F(x, \Xi) .
\]</span></p>
</div>
</section>
<section class="slide level2">

<p>and so as <span class="math inline">\(\theta \to \infty\)</span>, <span class="math display">\[\begin{aligned}
    &amp;
    \lim_{dt \searrow 0} \frac{1}{dt}
        \left. \mathbb{E} \left[ \int f(x) \bar \eta_{dt}(dx) - \int f(x) \bar \eta_0(dx) \;|\; \bar \eta_0 = \bar \eta \right] \right\vert_{t=0} \\
    &amp;\qquad
    \to
        \int \gamma(x, \Xi) \Delta\left(
                f(\cdot) r(\cdot, \Xi)
            \right)(x) \Xi(dx) \\
    &amp;\qquad \qquad {}
    + \int f(x) F(x, \Xi) \Xi(dx) .
\end{aligned}\]</span></p>
</section>
<section id="what-about-noise" class="slide level2">
<h2>What about noise?</h2>
<p>If reproduction is Poisson:</p>
<p><span class="math display">\[\begin{aligned}
    &amp;
    \lim_{dt \searrow 0} \frac{1}{dt}
        \left. \mathbb{E} \left[
                \left( \int f(x) \bar \eta_{dt}(dx) - \int f(x) \bar \eta_0(dx) \right)^2
            \;|\; \bar \eta_0 = \bar \eta \right] \right\vert_{t=0} \\
    &amp;\quad {}
    = \frac{\theta}{N}
    \left\{
        \int \gamma(x, \bar \eta)
            \int f^2(y) r(y, \bar \eta) q(x, dy)
        \bar \eta(dx)
    \right. \\
    &amp;\qquad \qquad \left. {}
    + \int \mu(x, \bar \eta) f^2(x) \bar \eta(dx)
    \right\} 
\end{aligned}\]</span></p>
<div class="fragment">
<p><span class="math display">\[\begin{aligned}
    &amp;\quad {}
    \propto \frac{\theta}{N} .
\end{aligned}\]</span></p>
</div>
</section>
<section id="when-is-the-limit-stochastic" class="slide level2">
<h2>When is the limit stochastic?</h2>
<p>Quadratic variation of the limit is nonzero if <span class="math display">\[ N = \rho \theta \]</span> for some <span class="math inline">\(\rho &gt; 0\)</span>.</p>
<div class="fragment">
<p>In other words, since dispersal distance is <span class="math inline">\(1/\sqrt{\theta}\)</span>: <span class="math display">\[\begin{aligned}
    N_\text{loc}
    &amp;:= \text{(mean number of individuals within distance $1/\sqrt{\theta}$)} \\
    &amp;\propto N / \theta \\
    &amp;= \rho .
\end{aligned}\]</span></p>
</div>
<div class="fragment">
<p>… i.e., if Wright’s neighbhood size is finite in the limit.</p>
</div>
</section>
<section id="deterministic-limits-thetan-to-0" class="slide level2">
<h2>Deterministic limits: <span class="math inline">\(\theta/N \to 0\)</span></h2>
<p>If the limiting measure has density <span class="math inline">\(\Xi_t(x) dx\)</span>, then it’s a weak solution to <span class="math display">\[\begin{aligned}
    \frac{d}{dt} \Xi_t(x)
    &amp;=
        r(x, \Xi) \Delta\left(
                \gamma(\cdot, \Xi_t) \Xi_t(\cdot)
            \right)(x)
        + F(x, \Xi_t) \Xi_t(x) .
\end{aligned}\]</span></p>
<div class="fragment">
<p>i.e., <span class="math display">\[\begin{aligned}
    \dot \Xi = r \Delta\left( \gamma \Xi \right) + F \Xi .
\end{aligned}\]</span></p>
</div>
</section>
<section id="reaction-diffusion-equations" class="slide level2">
<h2>Reaction-diffusion equations?</h2>
<p>Recall that e.g., <span class="math display">\[\begin{aligned}
r(x, \Xi)
    = r(\int p_\epsilon(x, y) \Xi(dy)) .
\end{aligned}\]</span></p>
<div class="fragment">
<p>… can we also take <span class="math inline">\(\epsilon \to 0\)</span>, getting <span class="math display">\[\begin{aligned}
    \frac{d}{dt} \Xi_t(x)
    &amp;=
        r(\Xi(x)) \Delta\left(
                \gamma(\Xi_t(\cdot)) \Xi_t(\cdot)
            \right)(x)
        + F(\Xi_t(x)) \Xi_t(x) ?
\end{aligned}\]</span></p>
</div>
</section>
<section id="what-do-we-need-to-know" class="slide level2">
<h2>What do we need to know?</h2>
<p>With <span class="math display">\[\bar \eta^\epsilon \to \Xi^\epsilon \qquad \text{as } \theta \to \infty,\]</span> can we take <span class="math inline">\(\epsilon \to 0\)</span> also so that <span class="math display">\[\bar \eta^\epsilon \to \Xi ? \]</span></p>
<div class="fragment">
<p>Since rates depend on <span class="math inline">\(p_\epsilon * \bar \eta\)</span>, it sufficies if</p>
<ol type="1">
<li><span class="math inline">\(p_\epsilon * \bar \eta^\epsilon \approx p_\epsilon * \Xi^\epsilon\)</span> (convergence as <span class="math inline">\(\theta \to \infty\)</span>)</li>
<li><span class="math inline">\(p_\epsilon * \Xi^\epsilon \approx p_\epsilon * \Xi\)</span> (needs more explicit conditions!)</li>
<li><span class="math inline">\(p_\epsilon * \Xi \approx \Xi\)</span> (solution is smooth)</li>
</ol>
</div>
</section></section>
<section>
<section id="but-careful-now" class="title-slide slide level1">
<h1>But, careful now…</h1>
<div class="floatright">
<figure>
<img data-src="figs/gilia.jpeg" style="width:40.0%" alt="Gilia Patterson" /><figcaption aria-hidden="true">Gilia Patterson</figcaption>
</figure>
<div class="caption">
<p><em>Gilia Patterson</em></p>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>death: <span class="math inline">\(\mu = 0.3\)</span> per generation</p></li>
<li><p>establishment: <span class="math inline">\(r = 0.7\)</span></p></li>
<li><p>dispersal: Gaussian with SD <span class="math inline">\(\sigma\)</span></p></li>
<li><p>local density: in circle of radius <span class="math inline">\(\epsilon\)</span></p></li>
<li><p>reproduction: with <span class="math inline">\(K=2\)</span>, <span class="math inline">\(\lambda=3\)</span>, <span class="math display">\[ \gamma = \frac{\lambda}{1 + \text{(local density)}/K} \]</span></p></li>
<li><p>non-spatial equilibrium density: <span class="math display">\[ K \left( \frac{\lambda}{1 - r} - 1 \right) .\]</span></p></li>
</ul>
<div class="fragment">
<p>Try it out yourself: SLiM code at <a href="https://github.com/petrelharp/cirm_2021_talk/gilia_clumping_sim.slim">github.com/petrelharp/cirm_2021_talk</a></p>
</div>
</section>
<section class="slide level2">

<ul>
<li>dispersal distance <span class="math inline">\(\sigma = 1/\sqrt{\theta} = 3\)</span></li>
<li>interaction distance <span class="math inline">\(\epsilon = 1\)</span></li>
</ul>
<div class="fragment">
<figure>
<img data-src="figs/gilia_high_sigma.png" alt="not patchy" /><figcaption aria-hidden="true">not patchy</figcaption>
</figure>
</div>
</section>
<section class="slide level2">

<ul>
<li>dispersal distance <span class="math inline">\(\sigma = 1/\sqrt{\theta} = 0.2\)</span></li>
<li>interaction distance <span class="math inline">\(\epsilon = 1\)</span></li>
<li>mean # offspring <span class="math inline">\(\gamma \propto (1 + \text{(density)} / K)^{-1}\)</span></li>
</ul>
<div class="fragment">
<figure>
<img data-src="figs/gilia_low_sigma.png" alt="not patchy" /><figcaption aria-hidden="true">not patchy</figcaption>
</figure>
</div>
</section>
<section class="slide level2">

<div class="centered">
<p><a href="https://doi.org/10.1006%2Fjtbi.1996.0370"><img data-src="figs/sasaki-title.png" alt="Clumped Distribution by Neighbourhood Competition, by A. Sasaki. Journal of Theoretical Biology 186 (4): 415–430 (June 1997)" /></a></p>
<figure>
<img data-src="figs/sasaki-bumps.png" alt="a figure from Sasaki 1997" /><figcaption aria-hidden="true">a figure from Sasaki 1997</figcaption>
</figure>
</div>
</section></section>
<section>
<section id="what-about-the-lineages" class="title-slide slide level1">
<h1>What about the lineages?</h1>

</section>
<section class="slide level2">

<p><strong>Goal:</strong> obtain a large-<span class="math inline">\(N\)</span> scaling limit of population density that <em>retains the notion of lineages</em>, in three cases:</p>
<ol type="1">
<li>superprocess</li>
<li>deterministic, nonlocal coefficients</li>
<li>deterministic, local coefficients</li>
</ol>
<div class="fragment">
<p><strong>Method:</strong> a lookdown construction, following <a href="https://dx.doi.org/10.1214/10-AOP574">Kurtz &amp; Rodrigues 2011</a> and <a href="https://dx.doi.org/10.1214/18-AOP1266">Etheridge &amp; Kurtz 2019</a>.</p>
</div>
</section>
<section id="deterministic-nonlocal-coefficients" class="slide level2">
<h2>Deterministic, nonlocal coefficients:</h2>
<p><em>Theorem:</em> Suppose that <span class="math display">\[\begin{aligned}
    r(x, \bar \eta) &amp;= r(x), \qquad \text{twice diff&#39;able} \\
    \gamma_\theta(x, \bar \eta)
        &amp;= \gamma(p_\epsilon * \bar \eta(x))
            + \frac{G(p_\epsilon * \bar \eta(x))}{\theta r(x)} \\
    \mu_\theta(x, \bar \eta)
        &amp;= \mu(p_\epsilon * \bar \eta(x))
            + \frac{H(p_\epsilon * \bar \eta(x))}{\theta} \\
    q_\theta(x, dy) &amp;= p_{1/\theta}(x, dy) ,
\end{aligned}\]</span> with <span class="math inline">\(\gamma\)</span>, <span class="math inline">\(G\)</span>, <span class="math inline">\(H\)</span>, and <span class="math inline">\(r\)</span> uniformly bounded and Lipschitz continuous. Then a lookdown construction with maximum level <span class="math inline">\(N \to \infty\)</span>, if <span class="math inline">\(\theta(N) / N \to 0\)</span>, converges in the sense of finite-dimensional distributions to a measure-valued process <span class="math inline">\((\eta_t^\infty)_{t \ge 0}\)</span>.</p>
</section>
<section id="theorem-continued" class="slide level2">
<h2>(theorem, continued)</h2>
<p>The limit is a Cox measure with intensity a product of <span class="math inline">\(\Xi_t \times \Lambda\)</span>, and for every continuous, bounded <span class="math inline">\(f : \mathbb{R}^d \to \mathbb{R}_+\)</span>, <span class="math display">\[\begin{aligned}
    &amp; \int f(x) \Xi_t(dx)
      - \int f(x) \Xi_0(dx) \\
    &amp;=
      \int_0^t \int
        \gamma(p_\epsilon * \Xi_s(x))
        \Delta \left( f(\cdot) r(\cdot) \right)(x) \\
    {}&amp;\qquad
        + f(x) \left\{
            G(p_\epsilon * \Xi_s(x))
            - H(p_\epsilon * \Xi_s(x))
        \right\}
      \xi_s(dx) ds .
\end{aligned}\]</span></p>
</section></section>
<section>
<section id="consequences-for-stationary-landscapes" class="title-slide slide level1">
<h1>Consequences for stationary landscapes</h1>

</section>
<section class="slide level2">

<p>If a deterministic, local limit holds, with dispersal <span class="math inline">\(N(m, \sigma^2 I)\)</span>, lineages should move in a stationary population density <span class="math inline">\(n(x) = d\Xi/dx\)</span> as <span class="math display">\[\begin{aligned}
    dL_t = r(L_t) \gamma(L_t) \left\{
            \left(
                2\sigma^2 \nabla \log(n\gamma)(L_t)  - m
            \right) dt
            + \sigma dB_t \right\} .
\end{aligned}\]</span></p>
<div class="fragment">
<p>i.e., as Brownian motion run at speed <span class="math inline">\(\sigma \gamma(y) n(y)\)</span> in the potential <span class="math display">\[\begin{aligned}
    n(y) \gamma(y) e^{-my/(2\sigma^2)} ,
\end{aligned}\]</span> … which has stationary distribution <span class="math display">\[\begin{aligned}
    \frac{n(y)}{r(y)} e^{-my/(2\sigma^2)} .
\end{aligned}\]</span></p>
</div>
</section></section>
<section>
<section id="lineages-in-expanding-populations" class="title-slide slide level1">
<h1>Lineages in expanding populations</h1>

</section>
<section class="slide level2">

<p>Many population models will <em>expand</em> into unoccupied habitat, e.g.:</p>
<div class="fragment">
<p>The classic Fisher-KPP equation: <span class="math display">\[\begin{aligned}
   dn = \left( \Delta n + s n (1-n) \right) dt 
\end{aligned}\]</span></p>
</div>
<div class="fragment">
<p>… or, with an Allee effect: <span class="math display">\[\begin{aligned}
   dn = \left( \Delta n + s n (1-n) (Cn - 1) \right) dt 
\end{aligned}\]</span></p>
</div>
</section>
<section class="slide level2">

<p>Recall that <span class="math display">\[\begin{aligned}
    \dot \Xi = r \Delta(\gamma \Xi) + F \Xi ,
\end{aligned}\]</span> where <span class="math display">\[\begin{aligned}
    F(x, \Xi) = r(x, \bar \eta) \gamma(x, \bar \eta) - \mu(x, \bar \eta) .
\end{aligned}\]</span></p>
<div class="fragment">
<p>So, we’d get <span class="math display">\[\begin{aligned}
   dn = \left( \Delta n + s n (1-n) (Cn - 1) \right) dt 
\end{aligned}\]</span> with <span class="math inline">\(r = \gamma = 1\)</span> and <span class="math display">\[\begin{aligned}
    \mu(x, n)
    =
    1 + s (n - 1) (Cn - 1) .
\end{aligned}\]</span></p>
</div>
</section>
<section id="travelling-waves" class="slide level2">
<h2>Travelling waves</h2>
<p>Suppose the population density has a traveling wave profile: <span class="math display">\[\begin{aligned}
    n(x,t) = w(x - ct)
\end{aligned}\]</span> and a determinstic, local limit holds:</p>
<div class="fragment">
<p>… then <span class="math inline">\(L - ct\)</span> has generator <span class="math display">\[\begin{aligned}
    \phi \mapsto r(x) \gamma(x) \left(
        2 \nabla \log(\gamma w)(x) \cdot \nabla \phi(x)
        + \Delta \phi(x)
    \right) 
        \\ \qquad {}
    + c \cdot \nabla \phi(x) .
\end{aligned}\]</span></p>
</div>
</section>
<section id="example-pme" class="slide level2">
<h2>Example: PME</h2>
<p>For instance, take the porous medium equation with logistic growth (in 1D): <span class="math display">\[\begin{aligned}
   \partial_t n_t(x) = \partial_x^2 [n_t(x)^2] + n_t(x) (1 - n_t(x)) ,
\end{aligned}\]</span> with stable solution <span class="math display">\[\begin{aligned}
    n_t(x) = \left( 1 - \exp\left( \frac{1}{2} (x - t) \right)\right)_+
\end{aligned}\]</span></p>
<div class="fragment">
<p>To get this, we want <span class="math inline">\(r=1\)</span> and <span class="math display">\[\begin{aligned}
    \gamma(x, n) &amp;= n(x) \\
    \mu(x, n) &amp;= 2 n(x) - 1 .
\end{aligned}\]</span></p>
</div>
</section>
<section class="slide level2">

<p>…so in the stationary frame, the lineage’s generator is <span class="math display">\[\begin{aligned}
    \phi 
    &amp;\mapsto 
    w(x) \left( \phi_{xx} + 4 (log w)_x \phi_x \right) + \phi_x \\
    &amp;=
    \left(1 - e^{x/2}\right) \phi_{xx}
            + \left(1 - 2 e^{x/2}\right) \phi_x \qquad \text{on } x &lt; 0.
\end{aligned}\]</span></p>
</section>
<section class="slide level2">

<div class="columns">
<div class="column">
<p>The lineage has stationary distribution <span class="math display">\[\begin{aligned}
    \pi(x) \propto e^x \left(1 - e^{x/2}\right) \qquad \text{for } x &lt; 0 .
\end{aligned}\]</span></p>
</div><div class="column" style="width:50%;">
<p><img data-src="figs/pme_dists.png" /></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script src="https://unpkg.com/reveal.js@^4//dist/reveal.js"></script>

  // reveal.js plugins
  <script src="https://unpkg.com/reveal.js@^4//plugin/notes/notes.js"></script>
  <script src="https://unpkg.com/reveal.js@^4//plugin/search/search.js"></script>
  <script src="https://unpkg.com/reveal.js@^4//plugin/zoom/zoom.js"></script>
  <script src="https://unpkg.com/reveal.js@^4//plugin/math/math.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display the page number of the current slide
        slideNumber: true,
        // Push each slide change to the browser history
        history: true,
        // Transition style
        transition: 'none', // none/fade/slide/convex/concave/zoom
        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [
          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    </body>
</html>
